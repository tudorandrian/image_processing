<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Processing Results</title>
</head>
<body>
    <h1>Image Processing Results</h1>
    <div>
        <h2>Action: {{ action }}</h2>
        <!-- Placeholder for additional results -->
    </div>
    <div>
        <h2>Uploaded Image</h2>
        <img src="{{ url_for('uploaded_file', filename=filename) }}" alt="Uploaded Image">
    </div>
    <div>
        <h2>Processed Image</h2>
        <img src="{{ url_for('uploaded_file', filename=processed_image) }}" alt="Processed Image">
    </div>
    <div>
        <h2>Detected Objects</h2>
        <ul>
            {% for detected_class in detected_classes %}
                <li>{{ detected_class }}</li>
            {% endfor %}
        </ul>
        {% if 'person' in detected_classes %}
        <div>
            <h2>Image with Face Detection</h2>
            <img src="{{ url_for('uploaded_file', filename=processed_image_person) }}" alt="Image with Face Detection">
        </div>
        {% endif %}
    </div>
    {% if 'person' in detected_classes %}
    <div>
        <h2>Emotion Analysis Results</h2>
        <table>
            <tr>
                <th>Dominant Emotion</th>
                <th>Face Confidence</th>
                <th>Emotions</th>
                <th>Region</th>
            </tr>
            {% for result in emotions %}
            <tr>
                <td>{{ result['dominant_emotion'] }}</td>
                <td>{{ result['face_confidence'] }}</td>
                <td>
                    <ul>
                        {% for emotion, value in result['emotion'].items() %}
                        <li>{{ emotion }}: {{ value }}</li>
                        {% endfor %}
                    </ul>
                </td>
                <td>{{ result['region'] }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    {% endif %}
    <div>
        <h2>Segmented Image</h2>
        <img src="{{ url_for('uploaded_file', filename=segmented_image) }}" alt="Segmented Image">
    </div>
    <!-- Add a section to display segmentation metrics -->
    <div>
        <h2>Segmentation Metrics</h2>
        <ul>
            <li>Number of Segments: {{ segmentation_metrics.num_segments }}</li>
            {% for segment in segmentation_metrics.segments %}
                <li>Segment ID: {{ segment.segment_id }}, Area: {{ segment.area }}, Percentage: {{ segment.percentage }}%</li>
            {% endfor %}
        </ul>
    </div>
    <div>
        <h2>Color Space: {{ color_space }}</h2>
        <!-- Placeholder for additional results -->
    </div>
    <div>
        <h2>Converted Image</h2>
        <img src="{{ url_for('uploaded_file', filename=converted_image) }}" alt="Converted Image">
    </div>
    <div>
        <h2>Transformed Image</h2>
        <img src="{{ url_for('uploaded_file', filename=transformed_image) }}" alt="Transformed Image">
    </div>
    <div>
        <h2>Filtered Image</h2>
        <img src="{{ url_for('uploaded_file', filename=filtered_image) }}" alt="Filtered Image">
    </div>
    <div>
        <h2>The edge-detected Image</h2>
        <img src="{{ url_for('uploaded_file', filename=edge_detected_image) }}" alt="The edge-detected Image">
    </div>
    <div>
        <h2>Equalized Image</h2>
        <img src="{{ url_for('uploaded_file', filename=equalized_image) }}" alt="Equalized Image">
    </div>
    <div>
        <h2>Image Enhancement</h2>
        <img src="{{ url_for('uploaded_file', filename=enhanced_image) }}" alt="Image Enhancement">
    </div>
</body>
</html>