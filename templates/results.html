<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Processing Results</title>
</head>
<body>
    <h1>Image Processing Results</h1>
    <div>
        <h2>Selected model name: {{ model_name }}</h2>
    </div>
    <div>
        <h2>Uploaded/Original Image</h2>
        <img src="{{ url_for('uploaded_file', filename=filename) }}" alt="Uploaded Image">
    </div>
    <div>
        <h2>Processed Image</h2>
        <img src="{{ url_for('uploaded_file', filename=processed_image) }}" alt="Processed Image">
    </div>
    <div>
        <h2>Detected Objects</h2>
        <ul>
            {% for detected_class in detected_classes %}
                <li>{{ detected_class }}</li>
            {% endfor %}
        </ul>
        {% if 'person' in detected_classes %}
        <div>
            <h2>Image with Face Detection</h2>
            <img src="{{ url_for('uploaded_file', filename=processed_image_person) }}" alt="Image with Face Detection">
        </div>
        {% endif %}
    </div>
    {% if 'person' in detected_classes %}
    <div>
        <h2>Emotion Analysis Results</h2>
        <table>
            <tr>
                <th>Dominant Emotion</th>
                <th>Face Confidence</th>
                <th>Emotions</th>
                <th>Region</th>
            </tr>
            {% for result in emotions %}
            <tr>
                <td>{{ result['dominant_emotion'] }}</td>
                <td>{{ result['face_confidence'] }}</td>
                <td>
                    <ul>
                        {% for emotion, value in result['emotion'].items() %}
                        <li>{{ emotion }}: {{ value }}</li>
                        {% endfor %}
                    </ul>
                </td>
                <td>{{ result['region'] }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    {% endif %}
    <div>
        <h2>Segmented Image</h2>
        <img src="{{ url_for('uploaded_file', filename=segmented_image) }}" alt="Segmented Image">
    </div>
    <!-- Add a section to display segmentation metrics -->
    <div>
        <h2>Segmentation Metrics</h2>
        <ul>
            <li>Number of Segments: {{ segmentation_metrics.num_segments }}</li>
            {% for segment in segmentation_metrics.segments[:10] %}
                <li>Segment ID: {{ segment.segment_id }}, Area: {{ segment.area }}, Percentage: {{ segment.percentage }}%</li>
            {% endfor %}
        </ul>
    </div>
    <div>
        <h2>Color Space: {{ color_space }}</h2>
        <!-- Placeholder for additional results -->
    </div>
    <!-- Converted Images Section -->
    <div>
        <h2>Converted Images</h2>
        {% if result_option == 'all' %}
            {% for color_space, image in converted_images.items() %}
                <img src="{{ url_for('uploaded_file', filename=image) }}" alt="{{ color_space }} Image">
                <h3>{{ color_space }} Color Space</h3>
                <p>{{ color_space_descriptions[color_space] }}</p>
            {% endfor %}
        {% else %}
            {% if color_space in converted_images %}
                <img src="{{ url_for('uploaded_file', filename=converted_images[color_space]) }}" alt="{{ color_space }} Image">
                <h3>{{ color_space }} Color Space</h3>
                <p>{{ color_space_descriptions[color_space] }}</p>
            {% endif %}
            {% for color_space, image in converted_images.items() %}
                <img src="{{ url_for('uploaded_file', filename=image) }}" alt="{{ color_space }} Image">
                <h3>{{ color_space }} Color Space</h3>
                <p>{{ color_space_descriptions[color_space] }}</p>
            {% endfor %}
        {% endif %}
    </div>
    <div>
        <h2>Transformed Image</h2>
        <img src="{{ url_for('uploaded_file', filename=transformed_image) }}" alt="Transformed Image">
    </div>
    <!-- Filtered Images Section -->
    <div>
        <h2>Filtered Images</h2>
        {% if result_option == 'all' %}
            {% for filter_type, image in filtered_images.items() %}
                <img src="{{ url_for('uploaded_file', filename=image) }}" alt="{{ filter_type }} Image">
                <h3>{{ filter_type | capitalize }} Filter</h3>
                <p>{{ filter_type_descriptions[filter_type] }}</p>
            {% endfor %}
        {% else %}
            {% if filter_type in filtered_images %}
                <img src="{{ url_for('uploaded_file', filename=filtered_images[filter_type]) }}" alt="{{ filter_type }} Image">
                <h3>{{ filter_type | capitalize }} Filter</h3>
                <p>{{ filter_type_descriptions[filter_type] }}</p>
            {% endif %}
            {% for filter_type, image in filtered_images.items() %}
                <img src="{{ url_for('uploaded_file', filename=image) }}" alt="{{ filter_type }} Image">
                <h3>{{ filter_type | capitalize }} Filter</h3>
                <p>{{ filter_type_descriptions[filter_type] }}</p>
            {% endfor %}
        {% endif %}
    </div>
    <!-- Edge-detected Images Section -->
    <div>
        <h2>Edge-detected Images</h2>
        {% if result_option == 'all' %}
            {% for algorithm, image in edge_detected_images.items() %}
                <img src="{{ url_for('uploaded_file', filename=image) }}" alt="{{ algorithm }} Image">
                <h3>{{ algorithm | capitalize }} Algorithm</h3>
                <p>{{ edge_algorithm_descriptions[algorithm] }}</p>
            {% endfor %}
        {% else %}
            {% if edge_algorithm in edge_detected_images %}
                <img src="{{ url_for('uploaded_file', filename=edge_detected_images[edge_algorithm]) }}" alt="{{ edge_algorithm }} Image">
                <h3>{{ edge_algorithm | capitalize }} Algorithm</h3>
                <p>{{ edge_algorithm_descriptions[edge_algorithm] }}</p>
            {% endif %}
            {% for algorithm, image in edge_detected_images.items() %}
                <img src="{{ url_for('uploaded_file', filename=image) }}" alt="{{ algorithm }} Image">
                <h3>{{ algorithm | capitalize }} Algorithm</h3>
                <p>{{ edge_algorithm_descriptions[algorithm] }}</p>
            {% endfor %}
        {% endif %}
    </div>
    <!-- Equalized Images Section -->
    <div>
        <h2>Equalized Images</h2>
        {% if result_option == 'all' %}
            {% for equalization_type, image in equalized_images.items() %}
                <img src="{{ url_for('uploaded_file', filename=image) }}" alt="{{ equalization_type }} Image">
                <h3>{{ equalization_type | capitalize }} Equalization</h3>
                <p>{{ equalization_type_descriptions[equalization_type] }}</p>
            {% endfor %}
        {% else %}
            {% if equalization_type in equalized_images %}
                <img src="{{ url_for('uploaded_file', filename=equalized_images[equalization_type]) }}" alt="{{ equalization_type }} Image">
                <h3>{{ equalization_type | capitalize }} Equalization</h3>
                <p>{{ equalization_type_descriptions[equalization_type] }}</p>
            {% endif %}
            {% for equalization_type, image in equalized_images.items() %}
                <img src="{{ url_for('uploaded_file', filename=image) }}" alt="{{ equalization_type }} Image">
                <h3>{{ equalization_type | capitalize }} Equalization</h3>
                <p>{{ equalization_type_descriptions[equalization_type] }}</p>
            {% endfor %}
        {% endif %}
    </div>
    <div>
        <h2>Enhanced Images</h2>
        {% if enhanced_images|length > 1 %}
            {% for image in enhanced_images %}
                <img src="{{ url_for('uploaded_file', filename=image) }}" alt="Enhanced Image">
            {% endfor %}
        {% else %}
            <img src="{{ url_for('uploaded_file', filename=enhanced_images[0]) }}" alt="Enhanced Image">
        {% endif %}
    </div>
</body>
</html>